$(document).ready(function(){function i(){$("img[realheader]").each(function(n,t){var i=$(t);i.attr("src",i.attr("realheader"))})}function t(n,t,i,r,u,f,e){var o=(t-1)*12,s=t*12,h=e.children();h.slice(o,s).fadeIn("slow",function(){var n=$(this).find("img[realheader]");n.attr("src",n.attr("realheader"))});u.toggleClass("current",!n&&s>=h.length&&!i);r.toggleClass("current",o===0);f.val(t)}function n(n){var i,r,t;n?(i="",$(".txtsearch").val("")):i=$(".txtsearch").val();r=$(".filterlink-container .selected").text().trim().toLocaleLowerCase();t="users";switch(r){case"teachers":t="teachers";break;case"students":t="students";break;default:t="users"}i?$("#"+t+" .username").each(function(){$(this).text().search(new RegExp(i,"i"))<0?$(this).closest(".element").hide():$(this).closest(".element").show()}):$("#"+t+" .element").show()}i();$(".teacher-student .filterlink-container .filterlink").click(function(){var t,r,i;n(!0);t=$(this);t.addClass("selected").siblings("a").removeClass("selected");r=t.data("type");i=$(".teacher-student .tiles-root-container");i.removeClass(i.attr("class").replace("tiles-root-container","")).addClass(r+"-container")});$(".teacher-student .tiles-root-container .pagination .prev, .teacher-student .tiles-root-container .pagination .next").click(function(){var i,a,r,w,v;if(n(!0),i=$(this),!i.hasClass("current")&&!i.hasClass("disabled")){var h=i.siblings("#curpage"),b=parseInt(h.val()),u=i.hasClass("prev"),c=b+(u?-1:1),e=u?i.siblings(".next"):i,o=u?i:i.siblings(".prev"),y=i.siblings("#nextlink"),l=y.val(),s=typeof l=="string"&&l.length>0;u&&(e=i.siblings(".next"),o=i);var p=i.closest(".tiles-secondary-container"),f=p.find(".content"),k=(c-1)*12;k<f.children().length?t(u,c,s,o,e,h,f):s&&(a=$(".teacher-student input#school-objectid").val(),r=p.attr("id"),r=r[0].toUpperCase()+r.substr(1),w="/Schools/"+a+"/"+r+"/Next",v=o.add(e),v.addClass("disabled"),$.ajax({type:"GET",url:w,dataType:"json",data:{schoolId:a,nextLink:l},contentType:"application/json; charset=utf-8",success:function(n){var l,i,u;if(n.error==="AdalException"||n.error==="Unauthorized"){alert("Your current session has expired. Please click OK to refresh the page.");window.location.reload(!1);return}(l=n[r],i=l.Value,i instanceof Array&&i.length!=0)&&(f.html(""),$.each(i,function(n,t){var i='<div class="element '+(t.ObjectType=="Teacher"?"teacher-bg":"student-bg")+'"><div class="userimg"><img src="/images/header-default.jpg" realheader="/Photo/UserPhoto/'+t.O365UserId+'" /><\/div><div class="username">'+t.DisplayName+"<\/div><\/div>";$(i).appendTo(f)}),u=l.NextLink,y.val(u),s=typeof u=="string"&&u.length>0,t(!1,c,s,o,e,h,f))},complete:function(){v.removeClass("disabled")}}))}});$("#btnsearch").click(function(){n()});$(".txtsearch").on("keypress",function(t){t.which===13&&n()})})